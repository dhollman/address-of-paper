<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>d0518r0: Restricting address reliance of function objects given to parallel algorithms in response to CH11</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em 0;
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: normal;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li li { font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed 1.0.0" name="generator">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-hidedel */

            #hidedel:checked ~ del, #hidedel:checked ~ * del { display:none; }
            #hidedel ~ #hidedel-label::before, #hidedel ~ * #hidedel-label::before { content: "☐ "; }
            #hidedel:checked ~ #hidedel-label::before, #hidedel:checked ~ * #hidedel-label::before { content: "☑ "; }
        </style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-syntax-highlighting */

        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
 <body class="h-entry">
  <input id="hidedel" style="display:none" type="checkbox">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">d0518r0<br>Restricting address reliance of function objects given to parallel algorithms in response to CH11</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Proposal, <time class="dt-updated" datetime="2016-11-09">9 November 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://wg21.link/p0518">http://wg21.link/p0518</a>
     <dt>Issue Tracking:
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt>Audience:
     <dd>SG1
     <dt>Toggle Diffs:
     <dd>
      <label for="hidedel" id="hidedel-label">Hide deleted text</label>
     <dt>Project:
     <dd><span>ISO JTC1/SC22/WG21: Programming Language C++</span>
    </dl>
   </div>
   <div data-fill-with="warning">
    <details class="annoying-warning" open="">
     <summary>Not Ready For Implementation</summary>
     <p> This spec is not yet ready for implementation.
		It exists in this repository to record the ideas and promote discussion. </p>
     <p> Before attempting to implement this spec,
		please contact the editors. </p>
    </details>
   </div>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>Address NB comment CH 11 in <a data-link-type="biblio" href="#biblio-p0488r0">[P0488R0]</a></p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#bg"><span class="secno">1</span> <span class="content">Background</span></a>
    <li><a href="#appr"><span class="secno">2</span> <span class="content">Approach</span></a>
    <li>
     <a href="#discuss"><span class="secno">3</span> <span class="content">Discussion</span></a>
     <ol class="toc">
      <li>
       <a href="#all_of"><span class="secno">3.1</span> <span class="content"><code class="highlight"><span class="n">all_of</span></code> [alg.all_of]</span></a>
       <ol class="toc">
        <li><a href="#conservative-approach"><span class="secno">3.1.1</span> <span class="content">Conservative approach</span></a>
        <li><a href="#flexible-approach"><span class="secno">3.1.2</span> <span class="content">Flexible approach</span></a>
       </ol>
      <li><a href="#any_of"><span class="secno">3.2</span> <span class="content"><code class="highlight"><span class="n">any_of</span></code> [alg.any_of]</span></a>
      <li><a href="#none_of"><span class="secno">3.3</span> <span class="content"><code class="highlight"><span class="n">none_of</span></code> [alg.none_of]</span></a>
      <li><a href="#foreach"><span class="secno">3.4</span> <span class="content"><code class="highlight"><span class="n">for_each</span></code> [alg.foreach]</span></a>
      <li>
       <a href="#find"><span class="secno">3.5</span> <span class="content"><code class="highlight"><span class="n">find</span></code> [alg.find]</span></a>
       <ol class="toc">
        <li><a href="#conservative-approach0"><span class="secno">3.5.1</span> <span class="content">Conservative approach</span></a>
        <li><a href="#flexible-approach0"><span class="secno">3.5.2</span> <span class="content">Flexible approach</span></a>
       </ol>
      <li>
       <a href="#find_end"><span class="secno">3.6</span> <span class="content"><code class="highlight"><span class="n">find_end</span></code> [alg.find.end]</span></a>
       <ol class="toc">
        <li><a href="#conservative-approach1"><span class="secno">3.6.1</span> <span class="content">Conservative approach</span></a>
        <li><a href="#less-conservative-approach"><span class="secno">3.6.2</span> <span class="content">Less conservative approach</span></a>
        <li><a href="#flexible-approach1"><span class="secno">3.6.3</span> <span class="content">Flexible approach</span></a>
       </ol>
      <li><a href="#find_first"><span class="secno">3.7</span> <span class="content"><code class="highlight"><span class="n">find_first</span></code> [alg.find.first.of]</span></a>
      <li><a href="#adjacent_find"><span class="secno">3.8</span> <span class="content"><code class="highlight"><span class="n">adjacent_find</span></code> [alg.adjacent.find]</span></a>
      <li><a href="#count"><span class="secno">3.9</span> <span class="content"><code class="highlight"><span class="n">count</span></code> [alg.count]</span></a>
      <li><a href="#mismatch"><span class="secno">3.10</span> <span class="content"><code class="highlight"><span class="n">mismatch</span></code> [mismatch]</span></a>
      <li><a href="#equal"><span class="secno">3.11</span> <span class="content"><code class="highlight"><span class="n">equal</span></code> [alg.equal]</span></a>
      <li><a href="#search"><span class="secno">3.12</span> <span class="content"><code class="highlight"><span class="n">search</span></code> [alg.search]</span></a>
      <li><a href="#copy_if"><span class="secno">3.13</span> <span class="content"><code class="highlight"><span class="n">copy_if</span></code> [alg.copy]</span></a>
      <li><a href="#transform"><span class="secno">3.14</span> <span class="content"><code class="highlight"><span class="n">transform</span></code> [alg.transform]</span></a>
      <li><a href="#replace_if-algreplace"><span class="secno">3.15</span> <span class="content"><code class="highlight"><span class="n">replace_if</span></code> [alg.replace]</span></a>
      <li><a href="#replace_copy_if-algreplace"><span class="secno">3.16</span> <span class="content"><code class="highlight"><span class="n">replace_copy_if</span></code> [alg.replace]</span></a>
      <li><a href="#remove_if-algremove"><span class="secno">3.17</span> <span class="content"><code class="highlight"><span class="n">remove_if</span></code> [alg.remove]</span></a>
      <li><a href="#remove_copy_if-algremove"><span class="secno">3.18</span> <span class="content"><code class="highlight"><span class="n">remove_copy_if</span></code> [alg.remove]</span></a>
      <li><a href="#unique-algunique"><span class="secno">3.19</span> <span class="content"><code class="highlight"><span class="n">unique</span></code> [alg.unique]</span></a>
      <li><a href="#unique_copy-algunique"><span class="secno">3.20</span> <span class="content"><code class="highlight"><span class="n">unique_copy</span></code> [alg.unique]</span></a>
      <li><a href="#partition-algpartition"><span class="secno">3.21</span> <span class="content"><code class="highlight"><span class="n">partition</span></code> [alg.partition]</span></a>
      <li><a href="#sort"><span class="secno">3.22</span> <span class="content"><code class="highlight"><span class="n">sort</span></code> [alg.sort]</span></a>
      <li><a href="#stable_sort-stablesort"><span class="secno">3.23</span> <span class="content"><code class="highlight"><span class="n">stable_sort</span></code> [stable.sort]</span></a>
     </ol>
    <li><a href="#word"><span class="secno">4</span> <span class="content">Proposed Wording</span></a>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="bg"><span class="secno">1. </span><span class="content">Background</span><a class="self-link" href="#bg"></a></h2>
   <p>National Body comment CH11 from <a data-link-type="biblio" href="#biblio-p0488r0">[P0488R0]</a> states:</p>
   <blockquote>
    <p>Comments: It may be useful to copy objects to a separate space for non-sequenced policies.</p>
    <p>Proposed Change: Add explicit allowance for non-sequenced policies to copy the objects
they work on.</p>
   </blockquote>
   <p>Discussion in SG1 at Issaquah on this comment led to the suggestion that, at minimum, wording should be added to some or all of the parallel algorithms forbidding the reliance on the <code class="highlight"><span class="n">addressof</span></code> operation for arguments to the function objects passed to a <em>parallel algorithm</em> [algorithms.parallel.defns].  A straw pole revealed unanimous agreement that a paper exploring this idea should be written.</p>
   <p>In particular, it was suggested that we examine the consequences of expanding or elaborating on the clause in [algorithms.parallel.user] to include language relating to the forbidding of reliance on the <code class="highlight"><span class="n">addressof</span></code> operator for arguments to certain function objects (particularly the ones called out in this section).</p>
   <h2 class="heading settled" data-level="2" id="appr"><span class="secno">2. </span><span class="content">Approach</span><a class="self-link" href="#appr"></a></h2>
   <p>In general, the consequences of this new restriction should be considered in the context of each  overloaded library function in <a data-link-type="biblio" href="#biblio-n4604">[N4604]</a> that takes an execution policy and at least one user-defined function object.  For many of these, we will attempt to propose at least two options, one that tries to be more conservative with respect to potential for different behavior compared to the serial (i.e., <code class="highlight"><span class="n">ExecutionPolicy</span></code>-free) overload, and one that tries to be more flexible with respect to implementer freedom, but allowing for different behavior from the serial overload in some (potentially far-fetched) cases.  For some algorithms, we may also propose one or more middle-ground options.</p>
   <p class="issue" id="issue-8f436473"><a class="self-link" href="#issue-8f436473"></a> TODO (perhaps?) consider the implications of restricting the <code class="highlight"><span class="n">addressof</span></code> forbiddance to arguments of <em>trivially copyable</em> type (or reference to <em>trivially copyable</em> type)</p>
   <h2 class="heading settled" data-level="3" id="discuss"><span class="secno">3. </span><span class="content">Discussion</span><a class="self-link" href="#discuss"></a></h2>
   <p class="issue" id="issue-7ab40449"><a class="self-link" href="#issue-7ab40449"></a> TODO broad discussion of the half-dozen or so general categories of use cases</p>
   <p class="issue" id="issue-b99af3b3"><a class="self-link" href="#issue-b99af3b3"></a> TODO discuss the general problem that, even in the algorithms that do not take function object arguments, <code class="highlight"><span class="k">operator</span><span class="o">=</span><span class="o">=</span></code> or <code class="highlight"><span class="k">operator</span><span class="o">!</span><span class="o">=</span></code> (for instance) could rely on the address of their arguments.</p>
   <h3 class="heading settled" data-level="3.1" id="all_of"><span class="secno">3.1. </span><span class="content"><code class="highlight"><span class="n">all_of</span></code> [alg.all_of]</span><a class="self-link" href="#all_of"></a></h3>
   <p>The sorts of <code class="highlight"><span class="n">Predicate</span></code> function objects that could be passed to <code class="highlight"><span class="n">all_of</span></code> that could rely on the address of the argument are very esoteric.  One use case that could have a <code class="highlight"><span class="n">Predicate</span></code> reliant on the <code class="highlight"><span class="n">addressof</span></code> the argument would be one that takes a modulus of that address to query consistency in the alignment of all items in a range (though there are probably better ways to do this).</p>
   <p>Another use would be to check if all of the objects in a range fall in between two addresses (for instance, to copy all elements with one <code class="highlight"><span class="n">memcpy</span></code> invocation).</p>
   <h4 class="heading settled" data-level="3.1.1" id="conservative-approach"><span class="secno">3.1.1. </span><span class="content">Conservative approach</span><a class="self-link" href="#conservative-approach"></a></h4>
    It would potentially be sufficient to preserve the alignment of the first element in the input range as well as the relative offsets of addresses of the other elements compared to the first, though this is unlikely to be widely important.  The second possible corner case would not necessarily be addressed by this approach. 
   <h4 class="heading settled" data-level="3.1.2" id="flexible-approach"><span class="secno">3.1.2. </span><span class="content">Flexible approach</span><a class="self-link" href="#flexible-approach"></a></h4>
    Forbid any reliance on <code class="highlight"><span class="n">addressof</span></code> operations on the argument to <code class="highlight"><span class="n">Predicate</span></code>. 
   <h3 class="heading settled" data-level="3.2" id="any_of"><span class="secno">3.2. </span><span class="content"><code class="highlight"><span class="n">any_of</span></code> [alg.any_of]</span><a class="self-link" href="#any_of"></a></h3>
    Similar to <a href="#all_of">§3.1 all_of [alg.all_of]</a>. 
   <h3 class="heading settled" data-level="3.3" id="none_of"><span class="secno">3.3. </span><span class="content"><code class="highlight"><span class="n">none_of</span></code> [alg.none_of]</span><a class="self-link" href="#none_of"></a></h3>
    Similar to <a href="#all_of">§3.1 all_of [alg.all_of]</a>. 
   <h3 class="heading settled" data-level="3.4" id="foreach"><span class="secno">3.4. </span><span class="content"><code class="highlight"><span class="n">for_each</span></code> [alg.foreach]</span><a class="self-link" href="#foreach"></a></h3>
    The function object passed to <code class="highlight"><span class="n">for_each</span></code> is not included in [algorithms.parallel.user], therefore the proposed changes would not apply to <code class="highlight"><span class="n">for_each</span></code>. 
   <h3 class="heading settled" data-level="3.5" id="find"><span class="secno">3.5. </span><span class="content"><code class="highlight"><span class="n">find</span></code> [alg.find]</span><a class="self-link" href="#find"></a></h3>
    The algorithms <code class="highlight"><span class="n">find_if</span></code> and <code class="highlight"><span class="n">find_if_not</span></code> both take <code class="highlight"><span class="n">Predicate</span></code> arguments.  In addition to the use cases in <a href="#all_of">§3.1 all_of [alg.all_of]</a> where the user might want to find an object with an address outside of a particular range or with a particular alignment, it may be desirable to check the containment of a non-equality-comparable ([equalitycomparable] in <a data-link-type="biblio" href="#biblio-n4604">[N4604]</a>) object in a given range.  We do not see an easy way to provide a conservative approach that preserves the correct behavior in this case. 
   <h4 class="heading settled" data-level="3.5.1" id="conservative-approach0"><span class="secno">3.5.1. </span><span class="content">Conservative approach</span><a class="self-link" href="#conservative-approach0"></a></h4>
    Under the same constraints as <a href="#all_of">§3.1 all_of [alg.all_of]</a>, some (but not all) possible corner cases could be handled.  There is no easy way that we can conceive of to constrain the proposed restriction to enable the non-equality-comparable containment use case.  It may be worth excluding <code class="highlight"><span class="n">find_</span><span class="o">*</span></code> functions from the <code class="highlight"><span class="n">addressof</span></code> restriction for this reason. 
   <h4 class="heading settled" data-level="3.5.2" id="flexible-approach0"><span class="secno">3.5.2. </span><span class="content">Flexible approach</span><a class="self-link" href="#flexible-approach0"></a></h4>
    Forbid any reliance on <code class="highlight"><span class="n">addressof</span></code> operations on the argument to <code class="highlight"><span class="n">Predicate</span></code>. <code class="highlight"><span class="n">Predicate</span></code>s like compare-by-address (as described above) would need to be run in serial or with a layer of indirection until more user-defined flexibility on the <code class="highlight"><span class="n">addressof</span></code> behavior could be added to the language by some means. 
   <h3 class="heading settled" data-level="3.6" id="find_end"><span class="secno">3.6. </span><span class="content"><code class="highlight"><span class="n">find_end</span></code> [alg.find.end]</span><a class="self-link" href="#find_end"></a></h3>
    Since <code class="highlight"><span class="n">find_end</span></code> operates on two different sequences, the analogs of the use cases in <a href="#find">§3.5 find [alg.find]</a> constitute a lot more esoteric use cases.  Whereas it is easy to envision a <code class="highlight"><span class="n">Predicate</span></code> to <code class="highlight"><span class="n">find_if</span></code> that is, for instance, a lambda that captures a reference to a desired value and compares its address to that of the argument passed to <code class="highlight"><span class="n">Predicate</span></code>, the analogous use case that takes a <code class="highlight"><span class="n">BinaryPredicate</span></code> is more likely to do something like compare the addresses of the arguments to <em>each other</em>, which is much more easily handled by the conservative approach 
   <h4 class="heading settled" data-level="3.6.1" id="conservative-approach1"><span class="secno">3.6.1. </span><span class="content">Conservative approach</span><a class="self-link" href="#conservative-approach1"></a></h4>
    For <code class="highlight"><span class="n">find_end</span></code> and most other algorithms that take a <code class="highlight"><span class="n">BinaryPredicate</span></code> function argument, it could be reasonable to provide a restriction intermediate to that of <a href="#find">§3.5 find [alg.find]</a> in which the relationship between the addresses of the arguments in any given call to the <code class="highlight"><span class="n">BinaryPredicate</span></code> remains unchanged (but allow the relationships between addresses of arguments in different calls to be completely unconstrained). 
   <h4 class="heading settled" data-level="3.6.2" id="less-conservative-approach"><span class="secno">3.6.2. </span><span class="content">Less conservative approach</span><a class="self-link" href="#less-conservative-approach"></a></h4>
    A slightly weaker restriction that still covers a lot of the use cases is to require only that the equality relationship on the addresses of the arguments be preserved.  This gives the implementation much more flexibility since it need not allocate memory the side of the distance between the argument addresses in order to make the call safely.  This approach also covers most of the use cases for most of the algorithms requiring <code class="highlight"><span class="n">BinaryPredicate</span></code> function objects. 
   <h4 class="heading settled" data-level="3.6.3" id="flexible-approach1"><span class="secno">3.6.3. </span><span class="content">Flexible approach</span><a class="self-link" href="#flexible-approach1"></a></h4>
    The flexible approach of completely forbidding <code class="highlight"><span class="n">addressof</span></code> operations on arguments to <code class="highlight"><span class="n">find_end</span></code> and most other algorithms that take a <code class="highlight"><span class="n">BinaryPredicate</span></code> has pretty much the same drawbacks as the other algorithms, with the caveat that the conservative approach is less restrictive and exposes much of the functionality (thus making the flexible approach slightly less appealing). 
   <h3 class="heading settled" data-level="3.7" id="find_first"><span class="secno">3.7. </span><span class="content"><code class="highlight"><span class="n">find_first</span></code> [alg.find.first.of]</span><a class="self-link" href="#find_first"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.8" id="adjacent_find"><span class="secno">3.8. </span><span class="content"><code class="highlight"><span class="n">adjacent_find</span></code> [alg.adjacent.find]</span><a class="self-link" href="#adjacent_find"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.9" id="count"><span class="secno">3.9. </span><span class="content"><code class="highlight"><span class="n">count</span></code> [alg.count]</span><a class="self-link" href="#count"></a></h3>
    The major concerns surrounding <code class="highlight"><span class="n">count</span></code> are similar to those of <a href="#any_of">§3.2 any_of [alg.any_of]</a> 
   <h3 class="heading settled" data-level="3.10" id="mismatch"><span class="secno">3.10. </span><span class="content"><code class="highlight"><span class="n">mismatch</span></code> [mismatch]</span><a class="self-link" href="#mismatch"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.11" id="equal"><span class="secno">3.11. </span><span class="content"><code class="highlight"><span class="n">equal</span></code> [alg.equal]</span><a class="self-link" href="#equal"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.12" id="search"><span class="secno">3.12. </span><span class="content"><code class="highlight"><span class="n">search</span></code> [alg.search]</span><a class="self-link" href="#search"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.13" id="copy_if"><span class="secno">3.13. </span><span class="content"><code class="highlight"><span class="n">copy_if</span></code> [alg.copy]</span><a class="self-link" href="#copy_if"></a></h3>
    Similar to <a href="#all_of">§3.1 all_of [alg.all_of]</a>, except that the alignment argument is a bit weaker here. 
   <h3 class="heading settled" data-level="3.14" id="transform"><span class="secno">3.14. </span><span class="content"><code class="highlight"><span class="n">transform</span></code> [alg.transform]</span><a class="self-link" href="#transform"></a></h3>
    We could not come up with a reasonable use case for which <code class="highlight"><span class="n">transform</span></code> would need a <code class="highlight"><span class="n">UnaryOperation</span></code> that depends on the address of its argument. 
   <h3 class="heading settled" data-level="3.15" id="replace_if-algreplace"><span class="secno">3.15. </span><span class="content"><code class="highlight"><span class="n">replace_if</span></code> [alg.replace]</span><a class="self-link" href="#replace_if-algreplace"></a></h3>
    Similar to <a href="#find">§3.5 find [alg.find]</a> 
   <h3 class="heading settled" data-level="3.16" id="replace_copy_if-algreplace"><span class="secno">3.16. </span><span class="content"><code class="highlight"><span class="n">replace_copy_if</span></code> [alg.replace]</span><a class="self-link" href="#replace_copy_if-algreplace"></a></h3>
    Similar to <a href="#find">§3.5 find [alg.find]</a> 
   <h3 class="heading settled" data-level="3.17" id="remove_if-algremove"><span class="secno">3.17. </span><span class="content"><code class="highlight"><span class="n">remove_if</span></code> [alg.remove]</span><a class="self-link" href="#remove_if-algremove"></a></h3>
    Similar to <a href="#find">§3.5 find [alg.find]</a> 
   <h3 class="heading settled" data-level="3.18" id="remove_copy_if-algremove"><span class="secno">3.18. </span><span class="content"><code class="highlight"><span class="n">remove_copy_if</span></code> [alg.remove]</span><a class="self-link" href="#remove_copy_if-algremove"></a></h3>
    Similar to <a href="#find">§3.5 find [alg.find]</a> 
   <h3 class="heading settled" data-level="3.19" id="unique-algunique"><span class="secno">3.19. </span><span class="content"><code class="highlight"><span class="n">unique</span></code> [alg.unique]</span><a class="self-link" href="#unique-algunique"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.20" id="unique_copy-algunique"><span class="secno">3.20. </span><span class="content"><code class="highlight"><span class="n">unique_copy</span></code> [alg.unique]</span><a class="self-link" href="#unique_copy-algunique"></a></h3>
    Similar to <a href="#find_end">§3.6 find_end [alg.find.end]</a> 
   <h3 class="heading settled" data-level="3.21" id="partition-algpartition"><span class="secno">3.21. </span><span class="content"><code class="highlight"><span class="n">partition</span></code> [alg.partition]</span><a class="self-link" href="#partition-algpartition"></a></h3>
    <code class="highlight"><span class="n">partition</span></code> and related functions (<code class="highlight"><span class="n">is_partitioned</span></code>, <code class="highlight"><span class="n">stable_partition</span></code>, <code class="highlight"><span class="n">partition_copy</span></code>) have a specific reasonable use case: radix sort binning.  We cannot come up with a reasonable conservative approach that works for this use case. 
   <h3 class="heading settled" data-level="3.22" id="sort"><span class="secno">3.22. </span><span class="content"><code class="highlight"><span class="n">sort</span></code> [alg.sort]</span><a class="self-link" href="#sort"></a></h3>
    The most compelling use case for <code class="highlight"><span class="n">sort</span></code> with a <code class="highlight"><span class="n">Compare</span></code> operation that relies on the addresses of its arguments is the sorting of locks for the purpose of deadlock avoidance.  We acknowledge that this is a legitimate use case and therefore suggest we consider explicitly excluding <code class="highlight"><span class="n">sort</span></code> from the <code class="highlight"><span class="n">addressof</span></code> restriction.  The conservative approach suggested for <a href="#find_end">§3.6 find_end [alg.find.end]</a> and other algorithms that take a <code class="highlight"><span class="n">BinaryPredicate</span></code> would cover this use case, though, as well as most of the other cases that take <code class="highlight"><span class="n">Compare</span></code> function objects. 
   <h3 class="heading settled" data-level="3.23" id="stable_sort-stablesort"><span class="secno">3.23. </span><span class="content"><code class="highlight"><span class="n">stable_sort</span></code> [stable.sort]</span><a class="self-link" href="#stable_sort-stablesort"></a></h3>
    Similar to <a href="#sort">§3.22 sort [alg.sort]</a> 
   <p><strong class="advisement"> There are more algorithms that could be considered in this section, but we feel we’ve covered most of the broad categories of use cases.  If SG1 feels it is necessary, we can extend this to include subsections for the rest of the parallel algorithms in <a data-link-type="biblio" href="#biblio-n4604">[N4604]</a></strong></p>
   <h2 class="heading settled" data-level="4" id="word"><span class="secno">4. </span><span class="content">Proposed Wording</span><a class="self-link" href="#word"></a></h2>
   <p>Change paragraph 1 of [algorithms.parallel.user] to:</p>
   <blockquote>
    <p>
     Function objects passed into parallel algorithms as objects of type <code class="highlight"><span class="n">Predicate</span></code>, <code class="highlight"><span class="n">BinaryPredicate</span></code>, <code class="highlight"><span class="n">Compare</span></code>, 
     <ins>UnaryOperation</ins>
      and <code class="highlight"><span class="n">BinaryOperation</span></code> shall not directly or indirectly modify objects via their arguments 
     <ins>or rely on the address of the objects unless otherwise specified for a specific algorithm.</ins>
    </p>
   </blockquote>
   <p class="issue" id="issue-42694933"><a class="self-link" href="#issue-42694933"></a> TODO: wording for specific sections where blanket change doesn’t make sense, as recommended by SG1 following discussion
issue: clarify what is restricted: can we take the address, or the result cannnot be relied on
issue: can we change it to effect of copy? can say the arguments may be a copy of the original, then avoid side effects of copy and move constructors.
issue: unify compare algorithm section starting with sort, compare can’t modify the arguments
issue: no observable effect different from trivially copyable</p>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-n4604">[N4604]
   <dd>Richard Smith. <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4604.pdf">C++17 CD Ballot Document</a>. 12 July 2016. URL: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4604.pdf">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4604.pdf</a>
   <dt id="biblio-p0488r0">[P0488R0]
   <dd>Barry Hedquist. <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf">WG21 Working paper: NB Comments, ISO/IEC CD 14882</a>. 18 October 2016. URL: <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf">http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> TODO (perhaps?) consider the implications of restricting the <code class="highlight"><span class="n">addressof</span></code> forbiddance to arguments of <em>trivially copyable</em> type (or reference to <em>trivially copyable</em> type)<a href="#issue-8f436473"> ↵ </a></div>
   <div class="issue"> TODO broad discussion of the half-dozen or so general categories of use cases<a href="#issue-7ab40449"> ↵ </a></div>
   <div class="issue"> TODO discuss the general problem that, even in the algorithms that do not take function object arguments, <code class="highlight"><span class="k">operator</span><span class="o">=</span><span class="o">=</span></code> or <code class="highlight"><span class="k">operator</span><span class="o">!</span><span class="o">=</span></code> (for instance) could rely on the address of their arguments.<a href="#issue-b99af3b3"> ↵ </a></div>
   <div class="issue"> TODO: wording for specific sections where blanket change doesn’t make sense, as recommended by SG1 following discussion
issue: clarify what is restricted: can we take the address, or the result cannnot be relied on
issue: can we change it to effect of copy? can say the arguments may be a copy of the original, then avoid side effects of copy and move constructors.
issue: unify compare algorithm section starting with sort, compare can’t modify the arguments
issue: no observable effect different from trivially copyable<a href="#issue-42694933"> ↵ </a></div>
  </div>